# 1. Tox21 화학 물질 독성 예측 프로젝트

![Python](https://img.shields.io/badge/Python-3.14-blue?logo=python)
![Pandas](https://img.shields.io/badge/Pandas-blue?logo=pandas)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-F7931E?logo=scikit-learn)
![RDKit](https://img.shields.io/badge/RDKit-Cheminformatics-orange)

> 본 프로젝트는 화학 물질의 독성 반응(Tox21) 데이터셋을 활용하여, **화학정보학(Cheminformatics)** 라이브러리인 `RDKit`으로 분자 특징을 추출하고, 머신러닝 모델을 통해 독성 여부를 예측하는 전 과정을 담고 있습니다.

---

## 📂 프로젝트 구조

* **`Tox21_Tutorial.ipynb`**: 데이터 전처리, 모델링, 해석의 전체 과정이 담긴 주피터 노트북 (이 프로젝트의 본체)
* **`tox21.csv.gz`**: 원본 데이터셋
* **`tree.png`**: 
![tree.png](tree.png)

---

## 🎯 1. 문제 정의: "지저분하고 불균형한" 실제 데이터

`df.info()`와 `df.describe()`로 초기 데이터를 탐색한 결과, 두 가지 심각한 문제를 발견했습니다.

1.  **엄청난 결측치 (Missing Data):** 총 7,831개의 데이터 중, 12개의 독성 타겟 컬럼 모두에 상당수의 결측치(NaN)가 존재했습니다.
2.  **극심한 데이터 불균형 (Imbalance):** `NR-AR` 컬럼을 예로 들면, 결측치를 제외한 3,079개의 데이터 중 비독성(0)이 3,020개인 반면, **독성(1)은 단 59개(약 1.9%)**에 불과했습니다.



---

## 🛠 2. 분석 전략 및 실행

이 프로젝트는 12개의 독성 타겟을 모두 예측하는 것이 아닌, 이 두 가지 핵심 문제를 해결하는 **'방법론'**을 정립하는 것을 목표로 했습니다. 따라서 12개의 타겟 중 `NR-AR`을 대표로 선택하여 분석을 진행했습니다.

### 1단계: 데이터 전처리 (Data Preprocessing)
* **결측치 처리:** `dropna()`를 사용하여 12개 타겟 중 하나라도 결측치가 있는 행은 모두 제거, 3,079개의 순수 데이터셋을 확보했습니다.
* **데이터 불균형 해결:** `NR-AR`의 독성 샘플(1) 59개와 동일한 수의 비독성 샘플(0) 59개를 무작위로 추출하는 **언더샘플링(Undersampling)**을 수행, 50:50 비율의 균형 잡힌 데이터셋(`df_balanced`)을 생성했습니다. (총 118개 샘플)

### 2단계: 특성 공학 (Feature Engineering) - `RDKit` 활용
모델이 학습할 수 있도록, 화학 구조 문자열(`smiles`)로부터 **화학정보학(Cheminformatics)** 라이브러리인 `RDKit`을 사용하여 217개의 **분자 디스크립터(Molecular Descriptors)**를 추출했습니다.

* **(Before)** `smiles` (문자열) ➡️ **(After)** `MaxAbsEStateIndex`, `HeavyAtomMolWt` 등 217개의 숫자형 특성(Feature)

### 3단계: 반복적인 모델링 및 개선
데이터의 특징을 파악하기 위해 단순한 모델부터 복잡한 모델까지 단계적으로 적용했습니다.

* **1차 시도: 로지스틱 회귀 (Logistic Regression)**
    * **결과:** **실패 (정확도 50%)**
    * **분석:** 혼돈 행렬 `[[0, 12], [0, 12]]`에서 볼 수 있듯이, 모델이 비독성(0)은 단 하나도 맞히지 못하고 **모든 샘플을 독성(1)으로만 예측**했습니다. 이는 데이터의 패턴이 단순한 선형(Linear) 관계가 아님을 시사합니다.

* **2차 시도: 결정 트리 (Decision Tree)**
    * **결과:** **성공 (정확도 67%)**
    * **분석:** 비선형(Non-linear) 패턴을 학습할 수 있는 결정 트리 모델을 적용한 결과, 정확도가 50%에서 67%로 유의미하게 상승했습니다. `classification_report` 확인 결과, 두 클래스(0, 1) 모두 균형 있게 예측하는 것을 확인했습니다.

---

## 💡 4. 결론 및 인사이트

### "모델은 무엇을 보았는가?" - 결정 트리 해석

결정 트리 모델의 장점은 '왜' 그런 예측을 했는지 **설명 가능하다**는 것입니다. `export_graphviz`로 모델 내부를 시각화한 결과, 모델이 다음과 같은 **화학적 특성**을 기준으로 독성 여부를 판단했음을 확인했습니다.

* **`HeavyAtomMolWt` (중원자 분자량)**
* **`BCUT2D_LOGPHI`**
* **`VSA_EState8`** 등



로지스틱 회귀의 50% 정확도(무작위 찍기)에서 67%로 성능이 향상된 것은, **RDKit으로 추출한 분자 디스크립터가 실제로 독성을 예측할 유의미한 정보를 담고 있으며**, 결정 트리 모델이 그 복잡한 패턴을 성공적으로 학습했음을 의미합니다.

### 향후 개선 방향
* **데이터 확보:** 3,079개로 줄어든 데이터를 `SMOTE` 같은 **오버샘플링(Oversampling)** 기법으로 보완.
* **모델 고도화:** 더 강력한 앙상블 모델(**Random Forest**, **XGBoost**)이나 딥러닝을 적용하여 67%의 정확도를 추가로 개선.
